import{_ as i,c as a,o as n,a2 as e}from"./chunks/framework.pthEGswZ.js";const c=JSON.parse('{"title":"Development","description":"","frontmatter":{},"headers":[],"relativePath":"development/setup.md","filePath":"development/setup.md"}'),l={name:"development/setup.md"};function t(h,s,p,k,r,d){return n(),a("div",null,s[0]||(s[0]=[e(`<h1 id="development" tabindex="-1">Development <a class="header-anchor" href="#development" aria-label="Permalink to &quot;Development&quot;">​</a></h1><h2 id="dependencies" tabindex="-1"><strong>Dependencies</strong> <a class="header-anchor" href="#dependencies" aria-label="Permalink to &quot;**Dependencies**&quot;">​</a></h2><p>Requirements:</p><ul><li>Docker</li><li><a href="https://kind.sigs.k8s.io/" target="_blank" rel="noreferrer">Kind cluster</a></li></ul><h2 id="install-kind-clusters" tabindex="-1">Install Kind clusters <a class="header-anchor" href="#install-kind-clusters" aria-label="Permalink to &quot;Install Kind clusters&quot;">​</a></h2><p>The command below will create two clusters, installs calico plugin and configures BGP peering between them.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  ./config/generator/env/clusters.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span></span></code></pre></div><h2 id="run-local-controllers-from-repo" tabindex="-1">Run local controllers from repo <a class="header-anchor" href="#run-local-controllers-from-repo" aria-label="Permalink to &quot;Run local controllers from repo&quot;">​</a></h2><h3 id="run-anyapplication-controller-kind-cluster1" tabindex="-1">Run AnyApplication Controller (kind-cluster1) <a class="header-anchor" href="#run-anyapplication-controller-kind-cluster1" aria-label="Permalink to &quot;Run AnyApplication Controller (kind-cluster1)&quot;">​</a></h3><p>Checkout and build project:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Check out repository</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/HIRO-MicroDataCenters-BV/anyapplication-controller.git</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> anyapplication-controller/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Build project</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><p>Run Controller:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # install CRDS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use-context</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kind-kind-cluster1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # run controller    </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run-kind-kind-cluster1</span></span></code></pre></div><h3 id="run-mesh-controller-kind-cluster1" tabindex="-1">Run Mesh Controller (kind-cluster1) <a class="header-anchor" href="#run-mesh-controller-kind-cluster1" aria-label="Permalink to &quot;Run Mesh Controller (kind-cluster1)&quot;">​</a></h3><p>Install <a href="https://rust-lang.org/tools/install/" target="_blank" rel="noreferrer">cargo and rust</a> and build project:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Check out repository</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/HIRO-MicroDataCenters-BV/mesh-controller.git</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mesh-controller/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # build project</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  cargo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><p>Install <a href="https://github.com/openssl/openssl" target="_blank" rel="noreferrer">openssl</a> and generate private/public keys and configure them:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> genpkey</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -algorithm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ed25519</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -outform</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> der</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./private-key1.der&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pkey</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./private-key1.der&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -inform</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DER</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -pubout</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -outform</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DER</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./public-key1.der&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  echo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xxd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -plain</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -cols</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 32</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -32</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./private-key1.der</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./private-key1.hex&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  echo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xxd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -plain</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -cols</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 32</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -32</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./public-key1.der</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./public-key1.hex&quot;</span></span></code></pre></div><p>Note that this has to be done for all peers (clusters) and configured in the corresponding <code>kind-cluster&lt;X&gt;.yaml</code>.</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  private_key_path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./private-key1.hex&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  nodes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # public keys and endpoints of other known peers except self</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">public_key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;43b2bb39061bc3267e869303268a81734fb8767d3a17ee490813955bd734fd3a&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      endpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;localhost:9102&quot;</span></span></code></pre></div><p>Run controller:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # install CRDS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --context</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kind-kind-cluster1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./charts/mesh-controller/crds/meshpeer.yaml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # run controller    </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  cargo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./env/kind-cluster1.yaml</span></span></code></pre></div><h3 id="run-placement-controller-kind-cluster1" tabindex="-1">Run Placement Controller (kind-cluster1) <a class="header-anchor" href="#run-placement-controller-kind-cluster1" aria-label="Permalink to &quot;Run Placement Controller (kind-cluster1)&quot;">​</a></h3><p>Install <a href="https://github.com/astral-sh/uv" target="_blank" rel="noreferrer">uv</a> and build project</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Check out repository</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/HIRO-MicroDataCenters-BV/placement-controller.git</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> placement-controller/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # build project</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  uv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><p>Run controller:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  uv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> placement_controller.main</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./etc/kind-kind-cluster1.yaml</span></span></code></pre></div><h2 id="run-containerized-versions-via-helm-charts" tabindex="-1">Run containerized versions via helm charts <a class="header-anchor" href="#run-containerized-versions-via-helm-charts" aria-label="Permalink to &quot;Run containerized versions via helm charts&quot;">​</a></h2><ol><li>Generate test cluster configuration using script <a href="https://github.com/HIRO-MicroDataCenters-BV/anyapplication-controller/tree/main/config/generator" target="_blank" rel="noreferrer">here</a></li></ol><p>The command below will generate development configuration from ./config-dev.yaml file for two clusters - kind-cluster1 and kind-cluster2.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./generate.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./config-dev.yaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./target</span></span></code></pre></div><p>Note that the script will generate keys for all clusters. New ones are generated on every call.</p><ol start="2"><li>Execute install scripts for all clusters:</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># kind-kind-cluster1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./target/kind-kind-cluster1/anyapplication-install.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./target/kind-kind-cluster1/mesh-install.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./target/kind-kind-cluster1/placement-install.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># kind-kind-cluster2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./target/kind-kind-cluster2/anyapplication-install.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./target/kind-kind-cluster2/mesh-install.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./target/kind-kind-cluster2/placement-install.sh</span></span></code></pre></div><h2 id="remove-kind-clusters" tabindex="-1">Remove Kind clusters <a class="header-anchor" href="#remove-kind-clusters" aria-label="Permalink to &quot;Remove Kind clusters&quot;">​</a></h2><p>The command below will remove two kind clusters.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  ./config/generator/env/clusters.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> delete</span></span></code></pre></div>`,37)]))}const g=i(l,[["render",t]]);export{c as __pageData,g as default};
